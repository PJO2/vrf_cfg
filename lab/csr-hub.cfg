
!
! Last configuration change at 13:29:43 UTC Wed Jun 9 2021 by cisco
!
version 16.9
service timestamps debug datetime msec
service timestamps log datetime msec
platform qfp utilization monitor load 80
no platform punt-keepalive disable-kernel-core
platform console auto
!
hostname csr-hub
!
boot-start-marker
boot system bootflash:csr1000v-universalk9.16.09.05.SPA.bin
boot-end-marker
!
!
vrf definition CA
 rd 65000:900021
 route-target import 65000:21
 !
 address-family ipv4
 exit-address-family
!
vrf definition Metier
 rd 65000:900031
 route-target import 65000:31
 !
 address-family ipv4
 exit-address-family
!
vrf definition VideoExterne
 rd 65000:900041
 route-target import 65000:41
 !
 address-family ipv4
 exit-address-family
!
vrf definition VideoInterne
 rd 65000:900042
 route-target import 65000:42
 !
 address-family ipv4
 exit-address-family
!
!
aaa new-model
!
!
aaa authentication login default local
aaa authorization exec default local if-authenticated 
!
!
!
!
!
aaa session-id common
aaa policy interface-config allow-subinterface
!
!
!
!
!
!
!
no ip domain lookup
ip domain name local
!
!
!
login on-success log
!
!
!
!
!
!
!
subscriber templating
! 
! 
! 
! 
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3222202584
 enrollment selfsigned
 subject-name cn=IOS-Self-Signed-Certificate-3222202584
 revocation-check none
 rsakeypair TP-self-signed-3222202584
!
!
crypto pki certificate chain TP-self-signed-3222202584
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9A3OQ3NU20R
license accept end user agreement
license boot level appx
no license smart enable
diagnostic bootup level minimal
!
spanning-tree extend system-id
archive
 path bootflash:/ARCHIVES
!
netconf-yang
!
restconf
!
username cisco privilege 15 secret 5 $1$GC0J$xWJocjpBDz2GfyNQKuJ.f/
!
redundancy
!
!
!
!
!
!
! 
! 
!
!
interface Loopback100
 description -- SR to CEs peering --
 ip address 172.20.0.0 255.255.255.255
!
interface GigabitEthernet1
 description -- Administration Radequa --
 ip address 10.112.83.100 255.255.255.0
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet2
 no ip address
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet3
 description -- Trunk to WAN --
 no ip address
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet3.1663
 description -- OOB addmin --
 encapsulation dot1Q 1663
 ip address 172.16.63.100 255.255.255.0
!
interface GigabitEthernet3.2430
 encapsulation dot1Q 2430
 ip address 10.24.30.2 255.255.255.252
!
router bgp 65500
 template peer-policy CEs
  send-community both
 exit-peer-policy
 !
 template peer-session CEs
  remote-as 65000
  transport connection-mode passive
  ebgp-multihop 255
  timers 30 90
 exit-peer-session
 !
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 no bgp default route-target filter
 neighbor PE peer-group
 neighbor PE remote-as 25186
 neighbor PE description -- underlay --
 neighbor 10.24.30.1 peer-group PE
 neighbor 172.20.0.101 inherit peer-session CEs
 neighbor 172.20.0.102 inherit peer-session CEs
 !
 address-family ipv4
  network 172.20.0.0 mask 255.255.255.255
  neighbor PE prefix-list PEERs in
  neighbor PE prefix-list PEERs out
  neighbor 10.24.30.1 activate
 exit-address-family
 !
 address-family vpnv4
  neighbor 172.20.0.101 activate
  neighbor 172.20.0.101 send-community extended
  neighbor 172.20.0.101 inherit peer-policy CEs
  neighbor 172.20.0.101 route-map From_Limoges_Platon in
  neighbor 172.20.0.101 route-map To_Limoges_Platon out
  neighbor 172.20.0.102 activate
  neighbor 172.20.0.102 send-community extended
  neighbor 172.20.0.102 inherit peer-policy CEs
  neighbor 172.20.0.102 route-map From_Limoges_Dumas in
  neighbor 172.20.0.102 route-map To_Limoges_Dumas out
 exit-address-family
!
!
virtual-service csr_mgmt
 ip shared host-interface GigabitEthernet1
 activate
!
iox
ip forward-protocol nd
no ip http server
ip http authentication local
ip http secure-server
ip route 0.0.0.0 0.0.0.0 10.112.83.129
ip route 172.20.0.0 255.255.0.0 10.24.30.1 name --scaling-test--
ip route 193.105.90.0 255.255.255.0 10.112.83.126
!
ip extcommunity-list standard Contract_555 permit rt 65500:555
ip extcommunity-list standard rt_Limoges permit rt 65500:555
ip bgp-community new-format
ip scp server enable
!
!
ip prefix-list DENY seq 5 deny 0.0.0.0/0 le 32
!
ip prefix-list PEERs seq 5 permit 172.20.0.0/20 le 32
!
!
route-map To_Limoges_Dumas permit 555 
 description -- cpe Limoges_Dumas, contrat Limoges --
 match extcommunity rt_Limoges
!
route-map From_Limoges_Dumas permit 10 
 description -- cpe Limoges_Dumas, contrat Limoges --
 set extcommunity rt 65500:555 additive
!
route-map To_Limoges_Platon permit 555 
 description -- cpe Limoges_Platon, contrat Limoges --
 match extcommunity rt_Limoges
!
route-map From_Limoges_Platon permit 10 
 description -- cpe Limoges_Platon, contrat Limoges --
 set extcommunity rt 65500:555 additive
!
!
!
!
!
control-plane
!
!
!
!
!
!
line con 0
 stopbits 1
line vty 0 4
 exec-timeout 120 0
 width 512
 escape-character 5
line vty 5 15
 exec-timeout 120 0
 escape-character 5
!
netconf ssh
!
!
!
!
!
end
