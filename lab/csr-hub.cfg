
!
! Last configuration change at 09:20:57 UTC Mon May 10 2021 by cisco
!
version 16.9
service timestamps debug datetime msec
service timestamps log datetime msec
platform qfp utilization monitor load 80
no platform punt-keepalive disable-kernel-core
platform console auto
!
hostname csr-hub
!
boot-start-marker
boot system bootflash:csr1000v-universalk9.16.09.05.SPA.bin
boot-end-marker
!
!
vrf definition Data1
 rd 65000:900031
 route-target import 65000:31
 !
 address-family ipv4
 exit-address-family
!
vrf definition Phone
 rd 65000:900046
 route-target import 65000:46
 !
 address-family ipv4
 exit-address-family
!
vrf definition Video
 rd 65000:900041
 route-target import 65000:41
 !
 address-family ipv4
 exit-address-family
!
!
aaa new-model
!
!
aaa authentication login default local
aaa authorization exec default local if-authenticated 
!
!
!
!
!
aaa session-id common
aaa policy interface-config allow-subinterface
!
!
!
!
!
!
!
no ip domain lookup
ip domain name local
!
!
!
login on-success log
!
!
!
!
!
!
!
subscriber templating
! 
! 
! 
! 
multilink bundle-name authenticated
!
!
!
!
!
crypto pki trustpoint TP-self-signed-3222202584
 enrollment selfsigned
 subject-name cn=IOS-Self-Signed-Certificate-3222202584
 revocation-check none
 rsakeypair TP-self-signed-3222202584
!
!
crypto pki certificate chain TP-self-signed-3222202584
!
!
!
!
!
!
!
!
license udi pid CSR1000V sn 9A3OQ3NU20R
license accept end user agreement
license boot level appx
no license smart enable
diagnostic bootup level minimal
!
spanning-tree extend system-id
!
netconf-yang
!
!
username cisco privilege 15 secret 5 $1$GC0J$xWJocjpBDz2GfyNQKuJ.f/
!
redundancy
!
!
!
!
!
!
! 
! 
!
!
interface Loopback100
 description -- SR to CEs peering --
 ip address 172.20.0.0 255.255.255.255
!
interface GigabitEthernet1
 description -- Administration Radequa --
 ip address 10.112.83.100 255.255.255.0
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet2
 no ip address
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet3
 description -- Trunk to WAN --
 no ip address
 negotiation auto
 no mop enabled
 no mop sysid
!
interface GigabitEthernet3.1663
 description -- OOB addmin --
 encapsulation dot1Q 1663
 ip address 172.16.63.100 255.255.255.0
!
interface GigabitEthernet3.2430
 description -- CPE GRT to WAN, no VRF awareness --
 encapsulation dot1Q 2430
 ip address 10.24.30.2 255.255.255.252
!
router bgp 65500
 bgp log-neighbor-changes
 bgp listen range 172.20.0.0/20 peer-group CEs
 no bgp default ipv4-unicast
 no bgp default route-target filter
 neighbor CEs peer-group
 neighbor CEs remote-as 65000
 neighbor CEs description -- inter AS Route server clients --
 neighbor CEs ebgp-multihop 255
 neighbor CEs update-source Loopback100
 neighbor CEs timers 30 90
 neighbor PE peer-group
 neighbor PE remote-as 25186
 neighbor PE description -- underlay --
 neighbor 10.24.30.1 peer-group PE
 !
 address-family ipv4
  network 172.20.0.0 mask 255.255.255.255
  neighbor PE prefix-list PEERs in
  neighbor PE prefix-list PEERs out
  neighbor 10.24.30.1 activate
 exit-address-family
 !
 address-family vpnv4
  neighbor CEs activate
  neighbor CEs send-community both
  neighbor CEs route-map mapSites2Contract in
 exit-address-family
!
!
virtual-service csr_mgmt
 ip shared host-interface GigabitEthernet1
 activate
!
ip forward-protocol nd
ip http server
ip http authentication local
ip http secure-server
ip route 193.105.90.0 255.255.255.0 10.112.83.126
!
ip extcommunity-list expanded vrf_Data1 permit RT:31:.*_
ip extcommunity-list expanded vrf_Video permit RT:41:.*_
ip extcommunity-list expanded site_Limoges001 permit RT:.*:101_
ip extcommunity-list expanded site_Nantes099 permit RT:.*:109_
ip extcommunity-list expanded vrf_Phone permit RT:46:.*_
ip bgp-community new-format
ip scp server enable
!
!
ip prefix-list DENY seq 5 deny 0.0.0.0/0 le 32
!
ip prefix-list PEERs seq 5 permit 172.20.0.0/20 le 32
!
!
route-map mapSites2Contract permit 3 
 match extcommunity vrf_Data1
 continue 30101
 set extcommunity rt 65000:31 additive
!
route-map mapSites2Contract permit 4 
 match extcommunity vrf_Video
 continue 40101
 set extcommunity rt 65000:41 additive
!
route-map mapSites2Contract permit 5 
 match extcommunity vrf_Phone
 continue 50101
 set extcommunity rt 65000:46 additive
!
route-map mapSites2Contract permit 6 
 continue 65535
!
route-map mapSites2Contract permit 30101 
 match extcommunity site_Limoges001
 set extcommunity rt 31:109 109:31 additive
!
route-map mapSites2Contract permit 30109 
 match extcommunity site_Nantes099
 set extcommunity rt 31:101 101:31 additive
!
route-map mapSites2Contract permit 39999 
 continue 65535
!
route-map mapSites2Contract permit 40101 
 match extcommunity site_Limoges001
 set extcommunity rt 41:109 109:41 additive
!
route-map mapSites2Contract permit 40109 
 match extcommunity site_Nantes099
 set extcommunity rt 41:101 101:41 additive
!
route-map mapSites2Contract permit 49999 
 continue 65535
!
route-map mapSites2Contract permit 50101 
 match extcommunity site_Limoges001
 set extcommunity rt 46:109 109:46 additive
!
route-map mapSites2Contract permit 50109 
 match extcommunity site_Nantes099
 set extcommunity rt 46:101 101:46 additive
!
route-map mapSites2Contract permit 59999 
 continue 65535
!
!
!
!
!
control-plane
!
!
!
!
!
!
line con 0
 stopbits 1
line vty 0 4
 exec-timeout 120 0
 escape-character 5
line vty 5 15
 exec-timeout 120 0
 escape-character 5
!
netconf ssh
!
!
!
!
!
end
